package modules;

import java.sql.SQLException;
import entities.AuthenticationData;

public class UserManager {
	
	public static boolean loginUserDoctor(String id, String plaintextPassword) throws SQLException {
		// Gets the user authentication data
		AuthenticationData authenticationData = DatabaseManager.getUserDoctorAuthenticationData(id);
		
		if (authenticationData == null)
			// User not found
			return false;
		
		// Computes the hash of the plaintext password concatenated with the salt as a prefix
		byte[] password = null; // TODO: use some hashing library to do SHA-512(unhex(salt) + plaintextPassword)
		
		// Compares the hashes
		return authenticationData.getPassword().equals(password);
	}
	
}
